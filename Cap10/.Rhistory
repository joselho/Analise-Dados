?data.frame
L3 <- LETTERS[1:3]
fac <- sample(L3, 10, replace = TRUE)
d <- data.frame(x = 1, y = 1:10, fac = fac)
View(d)
?rbind
cargas <- c(0.917, 0.874, -0.844, 0.031, 0.047, 0.077, 0.197, 0.979)
cbind(1,1:7)
cbind(0, rbind(1, 1:3))
rbind(cargas, 1:2)
cbind(cargas, 1:2)
cbind(cargas, 2)
cbind(cargas)
rbind(cargas)
split(cargas,2)
split(cargas,1/2)
split(cargas)
?split
split(1:10,1:2)
?rbind2
matrix(cargas, ncol=2)
?data.frame
data.frame(matrix(cargas, ncol = 2), row.names = vars)
vars <- c("idade", "rfixa", "rvariavel", "pessoas")
data.frame(matrix(cargas, ncol = 2), row.names = vars)
data.frame(matrix(cargas, ncol = 2), row.names = vars) %>% rename(F1=X1,F2=X2)
library(tidyverse)
data.frame(matrix(cargas, ncol = 2), row.names = vars) %>% rename(F1=X1,F2=X2)
vars <- c("idade", "rfixa", "rvariavel", "pessoas")
cargas <- c(0.917, 0.874, -0.844, 0.031, 0.047, 0.077, 0.197, 0.979)
data.frame(matrix(cargas, ncol = 2), row.names = vars) %>%
rename(F1 = X1, F2 = X2) -> df1
df2 %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 14)
library(kableExtra)
df1 %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 14)
pacotes <- c("plotly","tidyverse","knitr","kableExtra","car","rgl","gridExtra",
"PerformanceAnalytics","reshape2","rayshader","psych","ggrepel",
"factoextra","sp","tmap","magick","gridExtra","foreign")
if(sum(as.numeric(!pacotes %in% installed.packages())) != 0){
instalador <- pacotes[!pacotes %in% installed.packages()]
for(i in 1:length(instalador)) {
install.packages(instalador, dependencies = T)
break()}
sapply(pacotes, require, character = T)
} else {
sapply(pacotes, require, character = T)
}
df3 <- as.data.frame(read.dta(file = "PercepçãoDrogaria.dta"))
rho_drog <- cor(df3)
afpc_drog <- prcomp(scale(df3))
summary(afpc_drog)
View(afpc_drog)
#Relatório análise
data.frame(eigenvalue = afpc_drog$sdev ^ 2,
var_compartilhada = summary(afpc_drog)$importance[2,],
var_cumulativa = summary(afpc_drog)$importance[3,]) -> relat_drog
relat_drog %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 12)
data.frame(afpc_drog$rotation) %>%
mutate(var = names(df3)) %>%
melt(id.vars = "var") %>%
mutate(var = factor(var)) %>%
ggplot(aes(x = var, y = value, fill = var)) +
geom_bar(stat = "identity", color = "black") +
facet_wrap(~variable) +
labs(x = NULL, y = NULL, fill = "Legenda:") +
scale_fill_viridis_d() +
theme_bw()
#Quais os fatores e as cargas fatoriais?
k <- sum((afpc_drog$sdev ^ 2) > 1)
cargas_fatoriais <- afpc_drog$rotation[, 1:k] %*% diag(afpc_drog$sdev[1:k])
data.frame(cargas_fatoriais) %>%
rename(F1 = X1,
F2 = X2) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = T,
font_size = 12)
data.frame(cargas_fatoriais) %>%
rename(F1 = X1,
F2 = X2) %>%
mutate(Comunalidades = rowSums(cargas_fatoriais ^ 2)) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = T,
font_size = 12)
afpc_drog$sdev
afpc_drog$sdev^2
colSums(afpc_drog$sdev)
rowSums(afpc_drog$sdev)
sum(afpc_drog$sdev)
sum(afpc_drog$sdev^2)
afpc_drog$rotation
-0.9179228^2+0.1735888^2
(-0.9179228)^2+0.1735888^2
View(rho_drog)
afpc_drog[["scale"]]
afpc_drog[["rotation"]]
(-0.9179228)^2+(0.1735888)^2
(-0.9179228)^1/2+(0.1735888)^1/2
((-0.9179228)^2+(0.1735888)^2)^2
((-0.9179228)^2+(0.1735888)^2)^1/2
((-0.9179228)^1/2+(0.1735888)^1/2)^2
View(relat_drog)
View(afpc_drog)
df3 <- as.data.frame(read.dta(file = "PercepçãoDrogaria.dta"))
df3 %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 18)
rho_drog <- cor(df3)
afpc_drog <- prcomp(scale(df3))
summary(afpc_drog)
#Relatório análise
data.frame(eigenvalue = afpc_drog$sdev ^ 2,
var_compartilhada = summary(afpc_drog)$importance[2,],
var_cumulativa = summary(afpc_drog)$importance[3,]) -> relat_drog
relat_drog %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 12)
data.frame(afpc_drog$rotation) %>%
mutate(var = names(df3)) %>%
melt(id.vars = "var") %>%
mutate(var = factor(var)) %>%
ggplot(aes(x = var, y = value, fill = var)) +
geom_bar(stat = "identity", color = "black") +
facet_wrap(~variable) +
labs(x = NULL, y = NULL, fill = "Legenda:") +
scale_fill_viridis_d() +
theme_bw()
ggplotly(
fviz_eig(X = afpc_drog,
ggtheme = theme_bw(),
barcolor = "black",
barfill = "dodgerblue4",
linecolor = "darkgoldenrod4")
)
#Quais os fatores e as cargas fatoriais?
k <- sum((afpc_drog$sdev ^ 2) > 1)
cargas_fatoriais <- afpc_drog$rotation[, 1:k] %*% diag(afpc_drog$sdev[1:k])
data.frame(cargas_fatoriais) %>%
rename(F1 = X1,
F2 = X2) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = T,
font_size = 12)
cargas_fatoriais
sum(cargas_fatoriais[,1]^2)
sum(cargas_fatoriais[,2]^2)
sum(cargas_fatoriais[,1])
vars <- c("idade", "rfixa", "rvariavel", "pessoas")
cargas <- c(0.917, 0.874, -0.844, 0.031, 0.047, 0.077, 0.197, 0.979)
data.frame(matrix(cargas, ncol = 2), row.names = vars) %>%
rename(F1 = X1, F2 = X2) -> df1
df1 %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 14)
df1
sum(df1[,1:2]^2)
sum(df1[,1]^2)
sum(df1[,2]^2)
sum(df1[,.]^2)
sum(df1[,]^2)
data.frame(sum(df1[,1]^2),sum(df1[,1]^2))
?data.frame
data.frame(t(sum(df1[,1]^2),sum(df1[,1]^2)))
data.frame(c(sum(df1[,1]^2),sum(df1[,1]^2)))
c(sum(df1[,1]^2),sum(df1[,1]^2))
data.frame(c(sum(df1[,1]^2),sum(df1[,2]^2)))
data.frame(c(sum(df1[,1]^2),sum(df1[,2]^2))) %>% colnames("eigen")
data.frame(c(sum(df1[,1]^2),sum(df1[,2]^2))) %>% col.names("eigen")
data.frame(c(sum(df1[,1]^2),sum(df1[,2]^2))) %>% row.names(c("PC1","PC2"))
data.frame(c(sum(df1[,1]^2),sum(df1[,2]^2)))
colnames(df1)
data.frame(c(sum(df1[,1]^2),sum(df1[,2]^2)),row.names = colnames(df1))
data.frame(c(sum(df1[,1]^2),sum(df1[,2]^2)) %>% rename("eigen"),row.names = colnames(df1))
data.frame(rename("eigen"=c(sum(df1[,1]^2),sum(df1[,2]^2))),row.names = colnames(df1))
data.frame(c(sum(df1[,1]^2),sum(df1[,2]^2))) %>% row.names(c("PC1","PC2"))
data.frame(rename("eigen"=c(sum(df1[,1]^2),sum(df1[,2]^2))),row.names = colnames(df1))
data.frame(c(sum(df1[,1]^2),sum(df1[,2]^2)),row.names = colnames(df1))
data.frame(c(sum(df1[,1]^2),sum(df1[,2]^2)),row.names = colnames(df1)) %>% `colnames<-`("eigen")
#Eigenvalues e variância compartilhada
data.frame(c(sum(df1[,1]^2), sum(df1[,2]^2)),
row.names = colnames(df1)) %>%
colnames<-("eigen")
#Eigenvalues e variância compartilhada
data.frame(c(sum(df1[,1]^2), sum(df1[,2]^2)),
row.names = colnames(df1)) %>%
`colnames<-`("eigen")
#Eigenvalues e variância compartilhada
data.frame(c(sum(df1[,1]^2), sum(df1[,2]^2)),
row.names = colnames(df1)) %>%
`colnames<-`("eigen") -> relat1
relat1
View(afpc_drog)
data.frame(relat1, var_comp = relat1[,1]/2)
data.frame(relat1, var_comp = relat1[,1]*100/4)
data.frame(relat1, var_comp = relat1[,1]*100/4, var_acum = sum(relat1[,1]*100/4))
data.frame(relat1, var_comp = relat1[,1]*100/4, var_acum = sum(relat1[,.]*100/4))
data.frame(relat1, var_comp = relat1[,1]*100/4, var_acum = sum(relat1[,]*100/4))
data.frame(relat1, var_comp = relat1[,1]*100/4, var_acum = sum(var_comp))
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = sum(var_comp))
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = sum(var_comp[,1]))
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = sum(relat[,2]))
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = sum(relat1[,2]))
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = sum(relat1[,1]))
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = sum(relat1[,2]))
data.frame(relat1, var_comp = relat1[,1]*100/4, var_acum = var_comp)
data.frame(relat1, var_comp = relat1[,1]*100/4, var_acum = relat1[,1]*100/4)
data.frame(relat1, var_comp = relat1[,1]*100/4, var_acum = sum(relat1[,1]*100/4))
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = sum(var_comp))
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = var_comp)
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = relat1[,1])
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = relat1[,2])
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = colsums(var_comp))
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = colSums(var_comp))
colSums(relat[,1])
colSums(relat1[,1])
?colSums()
data.frame(relat1, var_comp = relat1[,1]*100/4) %>% mutate(var_acum = colSums(var_comp, dims = 2))
data.frame(relat1, var_comp = relat1[,1] * 100 / 4) -> relat1
View(relat1)
data.frame(relat1) %>% mutate(var_acum = sum(var_comp[, 1])
)
data.frame(relat1) %>% mutate(var_acum = sum(relat1[, 2]))
data.frame(relat1) %>%
mutate(var_acum = sum(relat1[, 2])) -> relat1
relat1 %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 14)
df1
rowSums(df1)
rowSums(df1^2)
df1
data.frame(cargas_fatoriais) %>%
rename(F1 = X1,
F2 = X2) %>%
mutate(Comunalidades = rowSums(cargas_fatoriais ^ 2)) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = T,
font_size = 12)
data.frame(df1) %>% mutate(comunalidades=rowSums(df1^2))
#Comunalidades
data.frame(df1) %>%
mutate(Comunalidades = rowSums(df1^2)) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = T,
font_size = 12)
#Comunalidades
data.frame(df1) %>%
mutate(Comunalidades = rowSums(df1^2)) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 12)
1397*2.1/100
1800*1.8/100
1800*1.3/100
data.frame(cargas_fatoriais) %>%
ggplot(aes(x = X1, y = X2)) +
geom_point(color = "orange") +
geom_hline(yintercept = 0, color = "darkorchid") +
geom_vline(xintercept = 0, color = "darkorchid") +
geom_text_repel(label = row.names(cargas_fatoriais)) +
labs(x = paste("F1", paste0("(",
round(summary(afpc_drog)$importance[2,1] * 100,
digits = 2),
"%)")),
y = paste("F2", paste0("(",
round(summary(afpc_drog)$importance[2,2] * 100,
digits = 2),
"%)"))) +
theme_bw()
relat1
df1
#Loading Plot
data.frame(df1) %>%
ggplot(aes(x = F1, y = F2)) +
geom_point(color = "orange") +
geom_hline(yintercept = 0, color = "darkorchid") +
geom_vline(xintercept = 0, color = "darkorchid") +
geom_text_repel(label = row.names(df1)) +
labs(x = paste("F1", paste0("(",
round(relat1[2,1], digits = 2),
"%)")),
y = paste("F2", paste0("(",
round(relat1[2,2], digits = 2),
"%)"))) +
theme_bw()
df1
relat1
#Loading Plot
data.frame(df1) %>%
ggplot(aes(x = F1, y = F2)) +
geom_point(color = "orange") +
geom_hline(yintercept = 0, color = "darkorchid") +
geom_vline(xintercept = 0, color = "darkorchid") +
geom_text_repel(label = row.names(df1)) +
labs(x = paste("F1", paste0("(",
round(relat1[1,2], digits = 2),
"%)")),
y = paste("F2", paste0("(",
round(relat1[2,2], digits = 2),
"%)"))) +
theme_bw()
pacotes <- c("plotly","tidyverse","knitr","kableExtra","car","rgl","gridExtra",
"PerformanceAnalytics","reshape2","rayshader","psych","ggrepel",
"factoextra","sp","tmap","magick","gridExtra","foreign")
if(sum(as.numeric(!pacotes %in% installed.packages())) != 0){
instalador <- pacotes[!pacotes %in% installed.packages()]
for(i in 1:length(instalador)) {
install.packages(instalador, dependencies = T)
break()}
sapply(pacotes, require, character = T)
} else {
sapply(pacotes, require, character = T)
}
vars <- c("idade", "rfixa", "rvariavel", "pessoas")
cargas <- c(0.917, 0.874, -0.844, 0.031, 0.047, 0.077, 0.197, 0.979)
data.frame(matrix(cargas, ncol = 2), row.names = vars) %>%
rename(F1 = X1, F2 = X2) -> CRM
CRM %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 14)
#Eigenvalues e variância compartilhada
data.frame(c(sum(CRM[,1]^2), sum(CRM[,2]^2)),
row.names = colnames(CRM)) %>%
`colnames<-`("eigen") -> relat1
relat1
data.frame(relat1, var_comp = relat1[,1] * 100 / 4) -> relat1
data.frame(relat1) %>%
mutate(var_acum = sum(relat1[, 2])) -> relat1
relat1 %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 14)
#Comunalidades
data.frame(df1) %>%
mutate(Comunalidades = rowSums(df1^2)) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 12)
#Comunalidades
data.frame(CRM) %>%
mutate(Comunalidades = rowSums(CRM^2)) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = F,
font_size = 12)
#Loading Plot
data.frame(CRM) %>%
ggplot(aes(x = F1, y = F2)) +
geom_point(color = "orange") +
geom_hline(yintercept = 0, color = "darkorchid") +
geom_vline(xintercept = 0, color = "darkorchid") +
geom_text_repel(label = row.names(CRM)) +
labs(x = paste("F1", paste0("(",
round(relat1[1,2], digits = 2),
"%)")),
y = paste("F2", paste0("(",
round(relat1[2,2], digits = 2),
"%)"))) +
theme_bw()
